<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

      <link rel="stylesheet" href="css/main.css">

      <script src="http://maps.googleapis.com/maps/api/js?libraries=weather,visualization,places&sensor=true&language=en&v=3.14"></script>

  </head>
  <body class="" ng-app="app">

    <!-- Add your site or application content here -->
    <div id="wrapper" class="wrapper" ui-view=""></div>

    <script src="cordova.js"></script>
    <script src="cdv-plugin-fb-connect.js"></script>
    <script src="facebook-js-sdk.js"></script>
    <script type="text/javascript" src="PushNotification.js"></script>

    <script src="js/app.js"></script>



    <script type="text/javascript" charset="utf-8">

      var pushNotification;

      document.addEventListener("deviceready", function () {
        if (typeof FB == 'undefined') {
          alert('FB variable does not exist. Check that you have included the Facebook JS SDK file.');
        }
        FB.init({ appId: "599935056750513", nativeInterface: CDV.FB, useCachedDialogs: false });

        pushNotification = window.plugins.pushNotification;


        var errorHandler = function(error) {
            alert('error = ' + error);
        }

        var successHandler = function(result) {
            alert('result = ' + result);
        }

        var tokenHandler =function (result) {
            // Your iOS push server needs to know the token before it can push to this device
            // here is where you might want to send it the token for later use.
            alert('device token = ' + result);
        }

        var onNotificationGCM =function(e) {
        switch( e.event )
        {
            case 'registered':
                if ( e.regid.length > 0 )
                {
                    console.log("Regid " + e.regid);
                    alert('registration id = '+e.regid);
                }
            break;

            case 'message':
              // this is the actual push notification. its format depends on the data model from the push server
              alert('message = '+e.message+' msgcnt = '+e.msgcnt);
            break;

            case 'error':
              alert('GCM error = '+e.msg);
            break;

            default:
              alert('An unknown GCM event has occurred');
              break;
        }
      }

        if ( device.platform == 'android' || device.platform == 'Android' )
        {
            pushNotification.register(
              successHandler,
              errorHandler, {
                  "senderID":"633864311576",
                  "ecb":"onNotificationGCM"
              });
        } else {
          pushNotification.register(
          tokenHandler,
          errorHandler, {
              "badge":"true",
              "sound":"true",
              "alert":"true",
              "ecb":"onNotificationAPN"
          });
        }




        onDeviceReady()
      });

      function onDeviceReady() {
        console.log('app loaded');
      }

      // onError: Failed to get the contacts
      function onError(contactError) {
        alert('onError!');
      }

    </script>
  </body>
</html>
